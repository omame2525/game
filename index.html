<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ãƒãƒ ã¡ã‚ƒã‚“ãƒ€ãƒƒã‚·ãƒ¥</title>

<style>
body {
  margin: 0;
  font-family: sans-serif;
  background: linear-gradient(#ffeef5, #ffd6e7);
  text-align: center;
}

h1 {
  font-size: 6vw;
  margin: 10px;
}

#nameInput {
  font-size: 4vw;
  padding: 5px;
  border-radius: 10px;
  border: none;
}

button {
  font-size: 4vw;
  padding: 8px 15px;
  border-radius: 15px;
  border: none;
  background: #ff9ecf;
  color: white;
  margin: 5px;
}

.track {
  position: relative;
  width: 95vw;
  height: 18vh;
  background: white;
  margin: 10px auto;
  border-radius: 15px;
  overflow: hidden;
}

.hamster {
  position: absolute;
  left: 0;
  top: 50%;
  transform: translateY(-50%);
  font-size: 8vw;
}

.nameTag {
  position: absolute;
  top: 5px;
  left: 5px;
  font-size: 3vw;
}

.goal {
  position: absolute;
  right: 5px;
  top: 5px;
  font-size: 4vw;
}
</style>
</head>
<body>

<h1>ğŸ¹ ãƒãƒ ã¡ã‚ƒã‚“ãƒ€ãƒƒã‚·ãƒ¥ ğŸ’¨</h1>

<div>
  ã‚ãªãŸã®åå‰ï¼š
  <input id="playerName" value="ã‚‚ã¡ã¾ã‚‹">
  <button onclick="startRace()">ãƒ¬ãƒ¼ã‚¹é–‹å§‹</button>
</div>

<div id="tracks"></div>

<div>
  <button onclick="boost()">ğŸ’— ã‚¿ãƒƒãƒ—ã§å¿œæ´ï¼</button>
</div>

<h2 id="result"></h2>

<script>
const cpuNames = [
"ã‚‚ãµã‚Šã‚“","ãã‚‹ã¿","ã½ã¦ã¡","ã¡ã‚‡ã“","ã„ã¡ã”","ã·ã‚Šã‚“","ã¿ã‚‹ã",
"ã¾ã‚ã‚“","ããªã“","ã‚ã‚“ãš","ãµã‚ã‚Š","ã“ã‚ã‚“","ã‚‚ã“ãŸã‚“","ã½ã½",
"ã‚‹ã‚‹","ã´ã®","ã¡ã‚ƒã‚€","ã“ã‚ã¾ã‚‹","ã—ã‚…ãŒãƒ¼","ã´ã‚‡ã“"
];

const personalities = [
  {name:"ã®ã‚“ã³ã‚Š", speed:1.5, stumble:0.05},
  {name:"ã‚ã‚ã¦ã‚“ã¼ã†", speed:2.5, stumble:0.15},
  {name:"ãã¾ãã‚Œ", speed:2.0, stumble:0.10},
  {name:"ã¦ã‚“ã•ã„", speed:3.0, stumble:0.03}
];

let racers = [];
let raceInterval;
let raceFinished = false;

function randomItem(arr){
  return arr[Math.floor(Math.random()*arr.length)];
}

function startRace(){
  document.getElementById("result").textContent="";
  raceFinished = false;
  clearInterval(raceInterval);
  document.getElementById("tracks").innerHTML="";
  racers=[];

  let playerName = document.getElementById("playerName").value || "ã‚ãªãŸ";
  let usedNames=[playerName];

  for(let i=0;i<3;i++){
    let name;
    if(i===0){
      name = playerName;
    } else {
      do{
        name = randomItem(cpuNames);
      } while(usedNames.includes(name));
    }
    usedNames.push(name);

    let personality = randomItem(personalities);

    let track = document.createElement("div");
    track.className="track";

    let nameTag = document.createElement("div");
    nameTag.className="nameTag";
    nameTag.textContent = name + "ï¼ˆ"+personality.name+"ï¼‰";

    let hamster = document.createElement("div");
    hamster.className="hamster";
    hamster.textContent="ğŸ¹";

    let goal = document.createElement("div");
    goal.className="goal";
    goal.textContent="ğŸ";

    track.appendChild(nameTag);
    track.appendChild(goal);
    track.appendChild(hamster);
    document.getElementById("tracks").appendChild(track);

    racers.push({
      name:name,
      personality:personality,
      element:hamster,
      position:0,
      isPlayer:i===0
    });
  }

  raceInterval = setInterval(updateRace,100);
}

function updateRace(){
  racers.forEach(r=>{
    if(raceFinished) return;

    if(!r.isPlayer){
      if(Math.random()<r.personality.stumble){
        return; // è»¢ã¶
      }
      r.position += r.personality.speed * Math.random();
    }

    r.element.style.left = r.position + "px";

    if(r.position > window.innerWidth*0.75){
      finishRace(r.name);
    }
  });
}

function boost(){
  if(raceFinished) return;
  let player = racers[0];
  player.position += 8;
  player.element.style.left = player.position + "px";
}

function finishRace(winner){
  raceFinished = true;
  clearInterval(raceInterval);

  if(winner === racers[0].name){
    document.getElementById("result").textContent="ğŸ‰ ã‚ãªãŸã®å‹ã¡ï¼";
  } else {
    document.getElementById("result").textContent="ğŸ’¦ "+winner+" ã®å‹ã¡ï¼";
  }
}
</script>

</body>
</html>